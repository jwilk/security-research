Misc suspicious code
====================

* https://git.savannah.gnu.org/cgit/bash.git/tree/support/bashbug.sh.in?h=bash-5.1#n44
* https://cgit.freedesktop.org/xdg/xdg-utils/tree/scripts/xdg-screensaver.in?h=v1.1.3#n34
* https://gitlab.com/dogtail/dogtail/-/blob/DOGTAIL_0_9_11/dogtail/config.py#L14
* https://github.com/Cisco-Talos/clamav/blob/main/clamsubmit/clamsubmit.c#L660
* https://sources.debian.org/src/vorbis-tools/1.4.0-11/debian/extra/vorbistagedit/#L86
* https://sourceware.org/git/?p=elfutils.git;a=blob;f=src/make-debug-archive.in;hb=elfutils-0.186#l25
* https://sourceware.org/git/?p=elfutils.git;a=blob;f=src/make-debug-archive.in;hb=elfutils-0.186#l125
* https://github.com/git/git/blob/master/contrib/git-jump/git-jump#L73
* https://github.com/util-linux/util-linux/blob/v2.37.4/misc-utils/look.1.adoc#examples
* https://sources.debian.org/src/tracker-miners/2.3.5-2.1/src/tracker-extract/tracker-extract-persistence.c/?hl=49#L41
* https://rr-project.org/ (``cd tmp``)
* https://salsa.debian.org/reproducible-builds/diffoscope/-/blob/215/diffoscope/comparators/python.py#L79
* https://github.com/gperftools/gperftools/blob/gperftools-2.10/docs/heap_checker.html#L329
* https://github.com/orjail/orjail/blob/v1.1/usr/sbin/orjail#L115
* https://hg.mozilla.org/releases/mozilla-release/file/FIREFOX_101_0_1_RELEASE/toolkit/content/aboutNetworking.js#l306
* https://hg.mozilla.org/releases/mozilla-release/file/FIREFOX_101_0_1_RELEASE/toolkit/content/aboutUrlClassifier.js#l631
* https://github.com/micahflee/torbrowser-launcher/blob/v0.3.5/torbrowser_launcher/common.py#L153
* https://github.com/brendangregg/perf-tools/blob/v1.0/opensnoop#L50
* https://github.com/openjdk/jdk/blob/jdk-18-ga/src/hotspot/share/utilities/vmError.cpp#L1383 (``/tmp/hs_err_pid*.log``)
* https://gitlab.gnome.org/GNOME/gimp/-/blob/GIMP_2_99_12/app/gegl/gimp-gegl.c#L117
* https://gitlab.gnome.org/GNOME/gimp/-/blob/GIMP_2_99_12/app/core/gimp.c#L1225
* https://gitlab.gnome.org/GNOME/gimp/-/blob/GIMP_2_99_12/libgimpbase/gimputils.c#L1278-1295 (pid may be misinterpreted as core)
* https://github.com/util-linux/util-linux/blob/v2.38.1/login-utils/login.c#L475 (chown/chmod race?)
* https://github.com/shadow-maint/shadow/blob/4.12.3/libmisc/chowntty.c#L30 (chown/chmod race?)
* https://github.com/JaGoLi/ytdl-gui/blob/3.0/src/mainactions.cpp#L236
* https://repo.or.cz/socat.git/blob/tag-1.7.4.3:/doc/socat.yo#l3427
* https://www.gnu.org/software/emacs/manual/html_node/elisp/File-Locks.html#index-lock_002dfile_002dname_002dtransforms

Editing files directly in (/var)/tmp
====================================

(See https://www.openwall.com/lists/oss-security/2017/10/31/5 for background.)

* https://git.joeyh.name/index.cgi/moreutils.git/tree/vidir?h=0.67#n118
* https://git.joeyh.name/index.cgi/moreutils.git/tree/vipe?h=0.67#n65
* https://sources.debian.org/src/mailcap/3.69/run-mailcap/
* https://sources.debian.org/src/vorbis-tools/1.4.0-11/debian/extra/vorbistagedit/#L85
* https://sources.debian.org/src/devscripts/2.21.3%2Bdeb11u1/scripts/bts.pl/#L4191
* https://github.com/quodlibet/quodlibet/blob/release-4.5.0/quodlibet/operon/commands.py#L227
* sudoedit(8)
* mutt(1), neomutt(1)
* https://github.com/AlecAivazis/survey/blob/v2.3.5/editor.go#L148
* https://www.cons.org/cracauer/sigint.html (``emacs /tmp/foo``)

System bootstraping into a direct subdirectory of (/var)/tmp
============================================================

* vmdebootstrap
* https://manpages.debian.org/bullseye/sbuild/sbuild-createchroot.8.en.html#EXAMPLES

netrc security
==============

(See https://jwilk.net/blog/20131104-netrc-security for background.)

TLS clients with netrc support:

* wget
* curl
* fetchmail
* https://github.com/psf/requests
* https://www.python-httpx.org/
* https://github.com/cli/cli/issues/288
* https://github.com/ytdl-org/youtube-dl
* https://github.com/yt-dlp/yt-dlp

CGI security
============

RFC 3875 §4.1.7 says:

   The QUERY_STRING variable contains a URL-encoded search or parameter
   string

Do HTTP servers ensure that the query string is actually URL-encoded?

(Failing to do so would facilitate exploiting argument injection vulnerabilities
in CGI shell scripts.)

Perl TLS security
=================

Does any software still use the ``Crypt::SSLeay`` module?

Does any software rely on the ``If-SSL-Cert-Subject`` header?

See also:

* https://github.com/libwww-perl/lwp-protocol-https/issues/13

* `[openssl.org #1425] Request: make X509_NAME_oneline() use same formatter as X509_NAME_print_ex() <https://marc.info/?l=openssl-dev&m=116301442815719>`_

TTY hijacking
=============

Bring up the topic of TTY hijacking via TIOCLINUX to oss-security.

GitHub
======

* What's going on with ``gpg_keys`` expiration dates?

  .. code:: console

     $ curl -s https://api.github.com/users/jwilk/gpg_keys | jq -r '.[0].expires_at'
     2022-12-09T02:49:23.000Z

  This looks unrelated the actual key expiration date.

* It used to be possible to associate unverified secondary e-mail addresses with commits:
  https://news.ycombinator.com/item?id=26621223

  Is this still the case?

* GitHub Actions runner images have world-writable ``/usr``.
  Huh?!

* Are newly-generated TOTP shared keys sufficiently long?
  https://news.ycombinator.com/item?id=31282917

APT
===

The `sources.list(5)`_ man page says:

   The file scheme […] is useful for NFS mounts and local mirrors or archives.

Is ``file://`` with NFS (or another networking fs) secure?

.. _sources.list(5):
   https://manpages.debian.org/bullseye/apt/sources.list.5.en.html#URI_SPECIFICATION

.. vim:ts=3 sts=3 sw=3 et ft=rst
